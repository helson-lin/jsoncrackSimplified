{"version":3,"file":"static/chunks/pages/widget-383fcc3012d6c8e8.js","mappings":"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","sources":["webpack://_N_E/?69cb","webpack://_N_E/./src/pages/widget.tsx"],"sourcesContent":["\n    (window.__NEXT_P = window.__NEXT_P || []).push([\n      \"/widget\",\n      function () {\n        return require(\"private-next-pages/widget.tsx\");\n      }\n    ]);\n    if(module.hot) {\n      module.hot.dispose(function () {\n        window.__NEXT_P.push([\"/widget\"])\n      });\n    }\n  ","import React from \"react\";\nimport dynamic from \"next/dynamic\";\nimport Head from \"next/head\";\nimport { useRouter } from \"next/router\";\nimport { useMantineColorScheme } from \"@mantine/core\";\nimport { ThemeProvider } from \"styled-components\";\nimport toast from \"react-hot-toast\";\nimport { darkTheme, lightTheme } from \"src/constants/theme\";\nimport { Toolbar } from \"src/containers/Toolbar\";\nimport useGraph from \"src/modules/GraphView/stores/useGraph\";\nimport useFile from \"src/store/useFile\";\n\ninterface EmbedMessage {\n  data: {\n    json?: string;\n    options?: {\n      theme?: \"light\" | \"dark\";\n      direction?: \"LEFT\" | \"RIGHT\" | \"DOWN\" | \"UP\";\n    };\n  };\n}\n\nconst GraphView = dynamic(() => import(\"src/modules/GraphView\").then(c => c.GraphView), {\n  ssr: false,\n});\n\nconst WidgetPage = () => {\n  const { query, push, isReady } = useRouter();\n  const { setColorScheme } = useMantineColorScheme();\n  const [theme, setTheme] = React.useState<\"dark\" | \"light\">(\"dark\");\n  const checkEditorSession = useFile(state => state.checkEditorSession);\n  const setContents = useFile(state => state.setContents);\n  const setDirection = useGraph(state => state.setDirection);\n  const clearGraph = useGraph(state => state.clearGraph);\n\n  React.useEffect(() => {\n    if (isReady) {\n      if (typeof query?.json === \"string\") checkEditorSession(query.json, true);\n      else clearGraph();\n\n      window.parent.postMessage(window.frameElement?.getAttribute(\"id\"), \"*\");\n    }\n  }, [clearGraph, checkEditorSession, isReady, push, query.json, query.partner]);\n\n  React.useEffect(() => {\n    const handler = (event: EmbedMessage) => {\n      try {\n        if (!event.data?.json) return;\n        if (event.data?.options?.theme === \"light\" || event.data?.options?.theme === \"dark\") {\n          setTheme(event.data.options.theme);\n        }\n\n        setContents({ contents: event.data.json, hasChanges: false });\n        setDirection(event.data.options?.direction || \"RIGHT\");\n      } catch (error) {\n        console.error(error);\n        toast.error(\"Invalid JSON!\");\n      }\n    };\n\n    window.addEventListener(\"message\", handler);\n    return () => window.removeEventListener(\"message\", handler);\n  }, [setColorScheme, setContents, setDirection, theme]);\n\n  React.useEffect(() => {\n    setColorScheme(theme);\n  }, [setColorScheme, theme]);\n\n  return (\n    <>\n      <Head>\n        <meta name=\"robots\" content=\"noindex,nofollow\" />\n      </Head>\n      <ThemeProvider theme={theme === \"dark\" ? darkTheme : lightTheme}>\n        <Toolbar isWidget />\n        <GraphView isWidget />\n      </ThemeProvider>\n    </>\n  );\n};\n\nexport default WidgetPage;\n"],"names":["window","__NEXT_P","push","__webpack_require__","GraphView","dynamic","Promise","all","e","then","bind","c","ssr","__webpack_exports__","query","isReady","useRouter","setColorScheme","useMantineColorScheme","theme","setTheme","React","checkEditorSession","useFile","state","setContents","setDirection","useGraph","clearGraph","json","parent","postMessage","frameElement","getAttribute","partner","handler","event","data","options","contents","hasChanges","direction","error","console","toast","addEventListener","removeEventListener","react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__","jsxs","Fragment","jsx","Head","meta","name","content","ThemeProvider","darkTheme","lightTheme","Toolbar","isWidget"],"sourceRoot":""}